# Домашнее задание к занятию «Компоненты Kubernetes» - Бодарев

## Задание. Необходимо определить требуемые ресурсы

Известно, что проекту нужны база данных, система кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:

1. Необходимо упаковать приложение в чарт для деплоя в разные окружения. 

2. База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 

3. Кеш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 

4. Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр, 0.2 ядра. 5 копий. 

5. Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

---

## Расчёт всех необходимых ресурсов

### База данных

Кол-во копий: 3

Память: 4 ГБ × 3 = 12 ГБ

CPU: 1 ядро × 3 = 3 ядра

### Кеш

Кол-во копий: 3

Память: 4 ГБ × 3 = 12 ГБ

CPU: 1 ядро × 3 = 3 ядра

### Фронтенд

Кол-во копий: 5

Память: 50 МБ × 5 = 250 МБ ≈ 0.25 ГБ

CPU: 0.2 ядра × 5 = 1 ядро

### Бекенд

Кол-во копий: 10

Память: 600 МБ × 10 = 6 ГБ

CPU: 1 ядро × 10 = 10 ядер

Итоговое потребление:

![image alt](https://github.com/vasionxxx/kuber-homeworks/blob/main/3.1/1.png)

## Расчёт рабочих нод

### Выберем тип ноды: 16 ГБ RAM, 8 CPU

На одной ноде поместится:

RAM: до 14 ГБ (оставим 2 ГБ на служебные нужды)

CPU: до 7 ядер (оставим 1 ядро под системные процессы)

### Примерная загрузка одной ноды:

14 ГБ RAM, 7 ядер

### Всего потребуется:

RAM: 30.25 ГБ / 14 ≈ 3 ноды

CPU: 17 / 7 ≈ 3 ноды

### Получается: 3 ноды по 16 ГБ / 8 CPU

## Добавим запас (HA / отказ одной ноды)

При выходе из строя одной ноды — нагрузка должна перераспределиться на оставшиеся.

Запас: +1 нода, т.е. всего 4 ноды

## Учёт служебных ресурсов и типов нод

### Служебные ресурсы на каждую ноду:

Kubernetes system pods, мониторинг, логирование и пр.

Закладываем ~2 ГБ RAM и 1 CPU на ноду.

Мы это уже учли в предыдущем шаге, оставив ресурсы для системных задач.

## Итоговое предложение по ресурсам:

### Количество нод: 4

### Тип ноды:

RAM: 16 ГБ

CPU: 8 ядер

### Обоснование:

Обеспечивают суммарно 56 ГБ RAM и 28 CPU, из них доступны для приложений ~48 ГБ и ~24 CPU.

Этого достаточно для всех компонентов + отказоустойчивость + служебные задачи.
